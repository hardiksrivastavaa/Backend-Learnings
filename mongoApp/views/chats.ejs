<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mini Whatsapp</title>
    <link rel="stylesheet" href="/style.css" />
</head>

<body>
    <h1>Mini Whatsapp - Chats</h1>

    <div class="chats-container">
        <div class="new-chat">
            <a href="/chats/new">New Chat</a>
        </div>

        <% chats.forEach(chat=> { %>

            <ul class="chats-list">
                <li>From : <%= chat.from %>
                </li>
                <li>Recieved By : <%= chat.to %>
                </li>
                <li>Message : <%= chat.msg %>
                </li>
                <li>Created Time : <%= chat.created_at.toString().split(" ")[4] %></li>
                <li>Created Date : <%= chat.created_at.toString().split(" ").slice(0,4).join(" -") %></li>

                <% if (chat.edited_at) { %>
                    <li>Edited Time : <%= chat.edited_at.toString().split(" ")[4] %></li>
                    <li>Edited Date : <%= chat.edited_at.toString().split(" ").slice(0,4).join(" -") %></li>
                <% } %>


                    <li class="btns">
                        <a href="/chats/<%= chat._id %>" style="background-color: blue">View</a>
                        <a href="/chats/<%= chat._id %>/edit" style="background-color: blue">Edit</a>
                        <form action="/chats/<%= chat._id %>/delete?_method=DELETE" method="post"><button onclick=alert()>Delete</button></form>
                    </li>
            </ul>
            <% }) %>
    </div>

    <script>
        function alert() {
            return confirm("Are you sure you want to delete this chat?")
        }
    </script>
</body>

</html>